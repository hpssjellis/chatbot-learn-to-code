<!DOCTYPE html>
<html>
<head>
    <title>Bitcoin Long-Term Power Law (Log-Log)</title>
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
</head>
<body style="font-family: 'Inter', sans-serif; margin: 0; padding: 20px; background-color: #f0f2f5; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh;">

    <div style="background-color: #ffffff; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); width: 95%; max-width: 1200px; box-sizing: border-box;">
        <h1 style="text-align: center; color: #333; margin-top: 0; margin-bottom: 20px; font-size: 2em;">Bitcoin Long-Term Power Law Prediction</h1>
        <div id="powerLawChart" style="width: 100%; height: 600px; border-radius: 8px; overflow: hidden;"></div>
    </div>

    <script>
        // Function to calculate days since January 3, 2009 (Bitcoin Genesis Block)
        function daysSinceGenesis(date) {
            const genesisDate = new Date('2009-01-03T00:00:00Z');
            const diffTime = Math.abs(date.getTime() - genesisDate.getTime());
            return Math.ceil(diffTime / (1000 * 60 * 60 * 24)); // Convert milliseconds to days
        }

        // Generate data for the Power Law, Support, and Resistance lines
        const xDays = []; // Will store days since genesis for the log x-axis
        const displayDates = []; // Will store formatted dates for hover info
        const powerLawPrices = [];
        const supportPrices = [];
        const resistancePrices = [];

        // Define the start and end dates for the chart
        const startDate = new Date('2009-01-03T00:00:00Z');
        const endDate = new Date('2030-12-31T00:00:00Z'); // Project prices until end of 2030

        let currentDate = new Date(startDate);
        while (currentDate <= endDate) {
            const days = daysSinceGenesis(currentDate);
            xDays.push(days); // Use days for the log x-axis
            displayDates.push(currentDate.toISOString().split('T')[0]); // Store formatted date for display

            // Power Law formula: Price = 10^-17 * (days)^5.8
            // To calculate this on a log scale, it's easier to work with logarithms:
            // log10(Price) = -17 + 5.8 * log10(days)
            // Price = 10 ^ (-17 + 5.8 * log10(days))
            const log10Price = -17 + 5.8 * Math.log10(days);
            const price = Math.pow(10, log10Price);
            powerLawPrices.push(price);

            // Estimate support and resistance bands.
            // The original Bitbo chart implies bands based on standard deviation.
            // For this example, we'll use a fixed percentage deviation for simplicity.
            // Adjust these percentages for a more accurate visual representation if needed.
            const supportFactor = 0.5; // Example: 50% below the power law line
            const resistanceFactor = 1.5; // Example: 50% above the power law line
            supportPrices.push(price * supportFactor);
            resistancePrices.push(price * resistanceFactor);

            // Increment date by 30 days to reduce the number of data points for smoother display
            currentDate.setDate(currentDate.getDate() + 30);
        }

        // Define the trace for the main Power Law line
        const tracePowerLaw = {
            x: xDays, // Use days for log x-axis
            y: powerLawPrices,
            mode: 'lines',
            name: 'Power Law',
            line: {
                color: '#4CAF50', // A pleasant green color
                width: 3
            },
            // Custom hover template to show actual dates
            hovertemplate: '<b>Date:</b> %{customdata}<br><b>Days:</b> %{x}<br><b>Price:</b> %{y:$,.2f}<extra></extra>',
            customdata: displayDates // Pass display dates as custom data for hover
        };

        // Define the trace for the Resistance band
        const traceResistance = {
            x: xDays, // Use days for log x-axis
            y: resistancePrices,
            mode: 'lines',
            name: 'Resistance',
            line: {
                color: '#FF6347', // Tomato red color
                width: 1.5,
                dash: 'dash' // Dashed line style
            },
            hovertemplate: '<b>Date:</b> %{customdata}<br><b>Days:</b> %{x}<br><b>Resistance:</b> %{y:$,.2f}<extra></extra>',
            customdata: displayDates
        };

        // Define the trace for the Support band
        const traceSupport = {
            x: xDays, // Use days for log x-axis
            y: supportPrices,
            mode: 'lines',
            name: 'Support',
            line: {
                color: '#4682B4', // Steel blue color
                width: 1.5,
                dash: 'dash' // Dashed line style
            },
            hovertemplate: '<b>Date:</b> %{customdata}<br><b>Days:</b> %{x}<br><b>Support:</b> %{y:$,.2f}<extra></extra>',
            customdata: displayDates
        };

        // Define the layout for the Plotly chart
        const layout = {
            title: {
                text: 'Bitcoin Long-Term Power Law Prediction',
                font: {
                    family: 'Inter, sans-serif',
                    size: 24,
                    color: '#333333'
                },
                x: 0.5, // Center the title
                xanchor: 'center'
            },
            xaxis: {
                title: {
                    text: 'Days Since Genesis (Log Scale)',
                    font: {
                        family: 'Inter, sans-serif',
                        size: 16,
                        color: '#555555'
                    }
                },
                type: 'log', // Set X-axis to logarithmic scale
                gridcolor: '#e0e0e0', // Light grey grid lines
                linecolor: '#cccccc', // Axis line color
                linewidth: 1,
                mirror: true,
                // For log scale, rangeslider and rangeselector might need custom logic or be less intuitive
                // Keeping them for now, but their behavior on log scale might be different than date axis.
                rangeslider: { visible: true },
                rangeselector: {
                    buttons: [
                        { count: 1, label: '1y', step: 'year', stepmode: 'backward',
                            // Adjusting for log scale: convert years to days and then to log scale range
                            // This is a simplified approximation and might not perfectly align with date ranges
                            // For precise date range selection on a log-days axis, more complex logic is needed.
                            // For now, these buttons will select a 'log-day' range.
                            // The 'year' stepmode is not directly applicable to a log-days axis.
                            // We'll leave it as is, but be aware of the conceptual mismatch.
                        },
                        { count: 5, label: '5y', step: 'year', stepmode: 'backward' },
                        { step: 'all' }
                    ]
                }
            },
            yaxis: {
                title: {
                    text: 'Price (USD) (Log Scale)',
                    font: {
                        family: 'Inter, sans-serif',
                        size: 16,
                        color: '#555555'
                    }
                },
                type: 'log', // Set Y-axis to logarithmic scale
                autorange: true, // Automatically adjust Y-axis range
                gridcolor: '#e0e0e0',
                linecolor: '#cccccc',
                linewidth: 1,
                mirror: true,
                tickprefix: '$' // Add dollar sign prefix to Y-axis ticks
            },
            margin: {
                l: 80, // Left margin
                r: 50, // Right margin
                b: 100, // Bottom margin (more space for range slider/selector)
                t: 80, // Top margin
                pad: 4
            },
            hovermode: 'x unified', // Show tooltips for all traces at a given X-coordinate
            showlegend: true,
            legend: {
                x: 0.01,
                y: 0.99,
                bgcolor: 'rgba(255, 255, 255, 0.8)',
                bordercolor: '#cccccc',
                borderwidth: 1,
                font: {
                    family: 'Inter, sans-serif',
                    size: 12,
                    color: '#333333'
                }
            },
            plot_bgcolor: '#f9f9f9', // Light grey plot background
            paper_bgcolor: '#ffffff', // White paper background
            responsive: true // Make the chart responsive
        };

        // Configuration options for Plotly.js
        const config = {
            responsive: true, // Make the chart responsive to window resizing
            displayModeBar: true, // Show the Plotly mode bar (zoom, pan, etc.)
            displaylogo: false // Hide the Plotly logo
        };

        // Create the new Plotly chart
        Plotly.newPlot('powerLawChart', [tracePowerLaw, traceResistance, traceSupport], layout, config);

        // Add a media query for smaller screens to adjust height if necessary
        window.addEventListener('resize', () => {
            const chartDiv = document.getElementById('powerLawChart');
            if (window.innerWidth < 768) {
                chartDiv.style.height = '400px'; // Shorter height for mobile
            } else {
                chartDiv.style.height = '600px'; // Default height for larger screens
            }
            Plotly.relayout(chartDiv, {}); // Re-render chart on resize
        });
        // Initial check for height on load
        window.dispatchEvent(new Event('resize'));

    </script>

</body>
</html>
